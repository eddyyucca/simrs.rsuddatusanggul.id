<div id="form_soap">
  <div class="col-md-3">
    <div class="panel panel-default">
      <div class="panel-body">
          <div class="form-group">
            <label for="tanggal">Tanggal</label>
            <input type="text" id="tgl_perawatan" name="tgl_perawatan" class="form-control tanggal" value="{?=date('Y-m-d')?}">
          </div>
          <div class="form-group">
            <label for="jam">Jam</label>
            <input type="text" id="jam_rawat" name="jam_rawat" class="form-control jam" value="{?=date('H:i:s')?}">
          </div>
          <div class="form-group">
            <label for="id_pendaftaran">Id Rawat</label>
            <input type="text" name="no_rawat" placeholder="ID Pendaftaran" class="form-control" value="" readonly>
          </div>
          <div class="form-group">
            <label for="id_pasien">Nomor RM</label>
            <input type="text" name="no_rkm_medis" id="no_rkm_medis" class="form-control" placeholder="Nomor Rekam Medik" value="" readonly>
          </div>
          <div class="form-group">
            <label for="nama_pasien">Nama Pasien</label>
            <input type="text" name="nm_pasien" class="form-control" placeholder="Nama pasien" value="" readonly>
          </div>
      </div>
    </div>
  </div>
  <div class="col-md-9">
    <div class="panel panel-default">
      <div class="panel-body">
        <h4 class="{if: $admin_mode == 'simple'}hidden{/if}">Pemeriksaan</h4>
        <div class="form-group {if: $admin_mode == 'simple'}hidden{/if}">
          <div class="row">
            <div class="col-sm-2">
              <label for="nama_pasien">Tensi(mmHg)</label>
              <input type="text" name="tensi" class="form-control" placeholder="" value="-">
            </div>
            <div class="col-sm-2">
              <label for="nama_pasien">Suhu(C)</label>
              <input type="text" name="suhu_tubuh" class="form-control" placeholder="" value="">
            </div>
            <div class="col-sm-2">
              <label for="nama_pasien">Nadi(/mnt)</label>
              <input type="text" name="nadi" class="form-control" placeholder="" value="">
            </div>
            <div class="col-sm-2">
              <label for="nama_pasien">RR(/mnt)</label>
              <input type="text" name="respirasi" class="form-control" placeholder="" value="">
            </div>
            <div class="col-sm-2">
              <label for="nama_pasien">Tinggi(cm)</label>
              <input type="text" name="tinggi" class="form-control" placeholder="" value="">
            </div>
            <div class="col-sm-2">
              <label for="nama_pasien">Berat(kg)</label>
              <input type="text" name="berat" class="form-control" placeholder="" value="">
            </div>
          </div>
        </div>
        <div class="form-group {if: $admin_mode == 'simple'}hidden{/if}">
          <div class="row">
            <div class="col-sm-3">
              <label for="nama_pasien">Kesadaran</label>
              <input type="text" name="kesadaran" class="form-control" placeholder="" value="Compos Mentis">
              <ul class="list-group" id="kesadaranList" style="z-index:1000;position:absolute;width:100%;"></ul>
            </div>
            <div class="col-sm-3">
              <label for="nama_pasien">GCS(E,V,M)</label>
              <input type="text" name="gcs" class="form-control" placeholder="" value="">
            </div>
            <div class="col-sm-3">
              <label for="nama_pasien">Alergi</label>
              <input type="text" name="alergi" class="form-control" placeholder="" value="">
            </div>
            <div class="col-sm-3">
              <label for="imun_ke">Imunisasi</label>
              <input type="text" name="imun_ke" class="form-control" placeholder="" value="-">
            </div>
          </div>
        </div>
        <h4>SOAP</h4>
        <div class="form-group">
          <label for="jenis">Subyektif</label>
          <textarea name="keluhan" id="keluhan" rows="2" class="form-control"></textarea>
        </div>
        <div class="form-group">
          <label for="jenis">Obyektif</label>
          <textarea name="pemeriksaan" id="pemeriksaan" rows="2" class="form-control"></textarea>
        </div>
        <div class="form-group">
          <label for="jenis">Assesment</label>
          <textarea name="penilaian" id="penilaian" rows="2" class="form-control"></textarea>
        </div>
        <div class="form-group">
          <label for="jenis">Plan</label>
          <textarea name="rtl" id="rtl" rows="2" class="form-control"></textarea>
        </div>
        <div class="form-group {if: $admin_mode == 'simple'}hidden{/if}">
          <label for="jenis">Instruksi</label>
          <textarea name="instruksi" id="instruksi" rows="2" class="form-control"></textarea>
        </div>
        <div class="m-t-xl">
          <button type="button" name="button" class="btn btn-primary" id="simpan_soap"><i class="fa fa-save"></i><span class="hidden-xs"> Simpan</span></button>
          <span class="{if: $admin_mode == 'simple'}hidden{/if}">
            <button type="button" name="button" class="btn btn-danger" id="buka_icd10dan9"><i class="fa fa-download"></i><span class="hidden-xs"> ICD 10 & 9</span></button>
          </span>
          <button type="button" name="button" class="btn btn-info" id="buka_riwayat"><i class="fa fa-file-o"></i><span class="hidden-xs"> Riwayat</span></button>
          <button type="button" name="button" class="btn btn-success" id="selesai_soap"><i class="fa fa-check"></i><span class="hidden-xs"> Selesai</span></button>
        </div>
      </div>
    </div>
    <div id="icd10dan9">
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="form-group">
            <div class="row">
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="">Diagnosa (ICD 10)</label>
                  <button id="filter" class="btn btn-default">
                      <span id="kode_icd10">kode</span>
                  </button>
                  <div class="btn-group">
                    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">
                      <span data-bind="label" id="prioritas_icd10"></span> <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" style="min-width:0px;">
                      <li><a>1</a></li>
                      <li><a>2</a></li>
                      <li><a>3</a></li>
                      <li><a>4</a></li>
                      <li><a>5</a></li>
                      <li><a>6</a></li>
                      <li><a>7</a></li>
                      <li><a>8</a></li>
                      <li><a>9</a></li>
                    </ul>
                  </div>
                  <div class="input-group">
                    <input type="text" name="icd10" id="icd10" class="form-control" />
                    <input type="hidden" name="status" class="form-control" value="Ralan" />
                    <ul class="list-group" id="icd10List" style="z-index:1000;position:absolute;width:100%;"></ul>
                    <span class="input-group-btn">
                      <button id="simpan_icd10" class="btn btn-primary btn-block">
                          <span class="glyphicon glyphicon-plus simpan_icd10"></span> Simpan
                      </button>
                    </span>
                  </div>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="">Prosedur (ICD 9)</label>
                  <button id="filter" class="btn btn-default">
                      <span id="kode_icd9">kode</span>
                  </button>
                  <div class="btn-group">
                      <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">
                          <span data-bind="label" id="prioritas_icd9"></span> <span class="caret"></span>
                      </button>
                      <ul class="dropdown-menu" role="menu" style="min-width:0px;">
                          <li><a>1</a></li>
                          <li><a>2</a></li>
                          <li><a>3</a></li>
                          <li><a>4</a></li>
                          <li><a>5</a></li>
                          <li><a>6</a></li>
                          <li><a>7</a></li>
                          <li><a>8</a></li>
                          <li><a>9</a></li>
                      </ul>
                  </div>
                  <div class="input-group">
                    <input type="text" name="icd9" id="icd9" class="form-control" />
                    <input type="hidden" name="status" class="form-control" value="Ralan" />
                    <ul class="list-group" id="icd9List" style="z-index:1000;position:absolute;width:100%;"></ul>
                    <span class="input-group-btn">
                        <button id="simpan_icd9" class="btn btn-primary btn-block">
                            <span class="glyphicon glyphicon-plus"></span> Simpan
                        </button>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="riwayatModal" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-full" role="document">
      <div class="modal-content">
          ...
      </div>
  </div>
</div>
<script type="text/javascript">
  $('input:text[name=kesadaran]').focus(function(){
       var output='';
       output+='<li class=\"list-group-item link-class\">Compos Mentis</li>';
       output+='<li class=\"list-group-item link-class\">Somnolence</li>';
       output+='<li class=\"list-group-item link-class\">Sopor</li>';
       output+='<li class=\"list-group-item link-class\">Coma</li>';
       output+='';
       $('#kesadaranList').fadeIn();
       $('#kesadaranList').html(output).show();
  });
  $('#kesadaranList').on('click', 'li', function(){
    $('input:text[name=kesadaran]').val($(this).text());
    $('#kesadaranList').fadeOut();
  });
</script>
<script type="text/javascript">
  $(document).ready(function () {
    $("#icd10dan9").hide();
  });
</script>
<script type="text/javascript">
  $(document).ready(function () {
    $(".icd9 .dropdown-menu li a").click(function () {
        var prioritas_icd9 = $(this).text();
        $(this).closest('.form-group').find('#prioritas_icd9').text(prioritas_icd9);
    });
  });
</script>
<script type="text/javascript">
  $(document).ready(function () {
    $(".icd10 .dropdown-menu li a").click(function () {
        var prioritas_icd10 = $(this).text();
        $(this).closest('.form-group').find('#prioritas_icd10').text(prioritas_icd10);
    });
  });
</script>
<script>
  $('#icd9').keyup(function(){
       var query = $(this).val();
       if(query != '')
       {
            $.ajax({
                 url: "{?=url([ADMIN, 'icd', 'icd9'])?}",
                 method:"POST",
                 data:{query:query},
                 success:function(data)
                 {
                      $('#icd9List').fadeIn();
                      $('#icd9List').html(data);
                 }
            });
       }
       $('#icd9List').fadeIn();
  });
  $('#icd9List').on('click', 'li', function(){
       $('#icd9').val($(this).text().split(': ')[1]);
       $('#kode_icd9').text($(this).text().split(': ')[0]);
       var kode_icd9 = $('#kode_icd9').val();
       $('#icd9List').fadeOut();
  });
</script>
<script>
  $('#icd10').keyup(function(){
       var query = $(this).val();
       if(query != '')
       {
            $.ajax({
                 url: "{?=url([ADMIN, 'icd', 'icd10'])?}",
                 method:"POST",
                 data:{query:query},
                 success:function(data)
                 {
                      $('#icd10List').fadeIn();
                      $('#icd10List').html(data);
                 }
            });
       }
       $('#icd10List').fadeIn();
  });
  $('#icd10List').on('click', 'li', function(){
       $('#icd10').val($(this).text().split(': ')[1]);
       $('#kode_icd10').text($(this).text().split(': ')[0]);
       var kode_icd10 = $('#kode_icd10').val();
       $('#icd10List').fadeOut();
  });
</script>
<script type="text/javascript">
  // tombol simpan diklik
  $("#form_soap").on("click", "#simpan_icd9", function(event){
    var baseURL = mlite.url + '/' + mlite.admin;
    event.preventDefault();
    var no_rawat = $('input:text[name=no_rawat]').val();
    var prioritas = $('#prioritas_icd9').text();
    var nama = $('input:text[name=icd9]').val();
    var kode = $('#kode_icd9').text();
    var status = $('input:hidden[name=status]').val();

    var url = baseURL + '/icd/saveicd9?t=' + mlite.token;

    $.post(url,{
      no_rawat: no_rawat,
      prioritas: prioritas,
      nama: nama,
      status: status,
      kode: kode
    } ,function(data) {
      $("#display_icd").show().load(baseURL + '/icd/display?no_rawat=' + no_rawat + '&t=' + mlite.token);
      //bersih();
      $('#notif').html("<div class=\"alert alert-success alert-dismissible fade in\" role=\"alert\" style=\"border-radius:0px;margin-top:-15px;\">"+
      "Data ICD 9 (Prosedur) pasien telah disimpan!"+
      "<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">&times;</button>"+
      "</div>").show();
    });
  });
</script>
<script type="text/javascript">
  // tombol simpan diklik
  $("#form_soap").on("click", "#simpan_icd10", function(event){
    var baseURL = mlite.url + '/' + mlite.admin;
    event.preventDefault();
    var no_rawat = $('input:text[name=no_rawat]').val();
    var prioritas = $('#prioritas_icd10').text();
    var nama = $('input:text[name=icd10]').val();
    var kode = $('#kode_icd10').text();
    var status = $('input:hidden[name=status]').val();

    var url = baseURL + '/icd/saveicd10?t=' + mlite.token;

    $.post(url,{
      no_rawat: no_rawat,
      prioritas: prioritas,
      nama: nama,
      status: status,
      kd_penyakit: kode
    } ,function(data) {
      $("#display_icd").show().load(baseURL + '/icd/display?no_rawat=' + no_rawat + '&t=' + mlite.token);
      //bersih();
      $('#notif').html("<div class=\"alert alert-success alert-dismissible fade in\" role=\"alert\" style=\"border-radius:0px;margin-top:-15px;\">"+
      "Data ICD 10 (Diagnosa) pasien telah disimpan!"+
      "<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">&times;</button>"+
      "</div>").show();
    });
  });
</script>
<script type="text/javascript">
  $("#form_soap").on("click","#buka_riwayat", function(event){
    var baseURL = mlite.url + '/' + mlite.admin;
    event.preventDefault();
    var no_rkm_medis = $('input:text[name=no_rkm_medis]').val();
    // window.open(baseURL + '/pasien/riwayatperawatan/' + no_rkm_medis + '?t=' + mlite.token);
    var loadURL =  baseURL + '/pasien/riwayatperawatan/' + no_rkm_medis + '?t=' + mlite.token;
    var modal = $('#riwayatModal');
    var modalContent = $('#riwayatModal .modal-content');

    modal.off('show.bs.modal');
    modal.on('show.bs.modal', function () {
        modalContent.load(loadURL);
    }).modal();

  });
</script>
<script type="text/javascript">
  // tombol buka form diklik
  $("#form_soap").on('click', '#buka_icd10dan9', function(){
    $("#icd10dan9").show();
    $("#buka_icd10dan9").val("Tutup Form");
    $("#buka_icd10dan9").attr("id", "tutup_icd10dan9");
  });

  // tombol tutup form diklik
  $("#form_soap").on('click', '#tutup_icd10dan9', function(){
    event.preventDefault();
    $("#icd10dan9").hide();
    $("#tutup_icd10dan9").val("Buka Form");
    $("#tutup_icd10dan9").attr("id", "buka_icd10dan9");
  });
</script>
